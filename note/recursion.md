# 递推求解
---
## 经典例子
- **汉诺塔**：
![](2025-03-25-11-05-20.png)
*思路*：把$n-1$个放到B位置，把最大的放到C位置，再把$n-1$个放到C位置。
**递推公式**：$H_n = 2H_{n-1} + 1$
- **计算比特串**
对不含2个连续0的n位二进制位串数个数，找出递推关系和初始条件。
*思路*：如果$a_n$的末尾为1，则前面$n-1$项要满足不含两个连续0，有$a_{n-1}$个。如果$a_n$的末尾为0，则第$n-1$位一定为1，则前$n-2$位要满足该要求，有$a_{n-2}$个。
**递推公式**：$a_n = a_{n-1} + a_{n-2}$

## 常见序列的递推公式

### 线性齐次递推关系
一个常系数k阶线性齐次关系递推关系形如：$$a_n = c_1a_{n-1} + c2a_{n-2} + \dots + c_ka_{n-k}$$的递推关系，其中$c_1, c_2, \dots c_k$为实数，且$c_k \neq 0$。
 - *k阶*：$a_n$是用之前的前$k$项来表示的
#### 求解递推关系：
将所有的$a_k$转化为$r^k$，得到**特征方程**:$$r^k - c_1r^{k-1}- c_2r^{k-2} - \dots - c_k = 0$$
 - 对于2阶的线性齐次关系：$r^2 - c_1r - c_2 = 0$
    - 如果有**两个不相等的根**$r_1,r_2$，那么递推关系为：$a_n = \alpha _1r_1^n + \alpha _2r_2^n$
    - 如果有**一个重根**$r_0$，那么递推关系为：$a_n = \alpha _1r_0^n + \alpha _2nr_0^n$ 
 - 对于任意阶数的线性齐次方程：$r^k - c_1r^{k-1} - \dots - c_k = 0$
    - 如果**有k个不同的根**$r_1, r_2, \dots, r_k$，那么递推关系为：$a_n = \alpha _1r_1^n + \alpha _2r_2^n + \dots + a_kr_k^n$。
    - 如果**有t个不同的根**，每个根的重数分别为$m_1,m_2, \dots, m_t$，那么递推关系为：$a_n = (\alpha _{1,0} + \alpha _{1, 1}n + \dots + \alpha _{1, m_1 - 1}n^{m_1 - 1})r_1^n + (\alpha _{2,0} + \alpha _{2, 1}n + \dots + \alpha _{2, m_2 - 1}n^{m_2 - 1})r_2^n + \dots + (\alpha _{t,0} + \alpha _{t, 1}n + \dots + \alpha _{t, m_t - 1}n^{m_t - 1})r_t^n$

### 常系数线性非齐次递推关系
一个常系数线性非齐次递推关系形如：$an = c_1a_{n-1} + c_2a_{n-2} + \dots + c_ka_{n - k} + F(n)$，其中$F(n)$是一个只依赖于n且不等于0的函数。
#### 求递推关系：
每个解都是$\{a_n^{(p)} + a_n^{(h)}\}$的形式，其中$\{a_n^{(h)}\}$是相伴的线性齐次递推关系的解，$\{a_n^{(p)}\}$是线性非齐次递推关系的一个特解。 

# 分治算法和递推求解
将一个大小为n的问题分解成a个子问题
- 每个子问题的大小为$\frac{n}{b}$
- 假设$g(n)$是算法处理步中需要额外操作的量
有：$f(n) = a f(\frac{n}{b}) + g(n)$
## 时间复杂度计算
- 对于$f(n) = af(\frac{n}{b}) + c$，如果n能被b整除时，$a\geq 1$，b是大于1的整数，c是正实数，有：$$f(n) is
\begin{cases}
O(n^{\log_ba}) & if \ \ a > 1\\
O(\log n) & if\ \ a = 1
\end{cases}
$$
- 对于$f(n) = af(\frac{n}{b}) + cn^d$，k是一个正整数，b是大于1的整数，c和d是实数，满足c是正且b、d是非负，有：
$$
f(n) is
\begin{cases}
O(n^d) & if\ \ a < b^d\\
O(n^d \log n) & if\ \ a = b^d\\
O(n^{\log_b a}) & if\ \ a > b^d
\end{cases}
$$